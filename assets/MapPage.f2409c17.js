import{d as D,r as c,s as k,c as C,u as x,b as g,t as L,g as B,h as E,q as P,p as b,j as S,o as h,C as T,v as I,x as N}from"./index.4a4f4885.js";import{_ as V}from"./houcdc0426e.js";const w=u=>(I("data-v-8ed97ee3"),u=u(),N(),u),$={class:"mapPage"},M=w(()=>g("div",{id:"container"},null,-1)),j={key:0,class:"radius padding"},G=w(()=>g("p",null,"\u60A8\u73B0\u5728\u7684\u4F4D\u7F6E\u662F\uFF1A",-1)),U=D({__name:"MapPage",setup(u){const n=b("$Utils"),d=c("");let i=null,v=null,s=c([0,0]),o=c([0,0]),F=50,_=c(!1);k(()=>{n.Message.showLoadingToast(),navigator.geolocation&&navigator.geolocation.getCurrentPosition(y)}),setTimeout(()=>{_.value||n.Message.failToast("\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u83B7\u53D6\u5F53\u524D\u4F4D\u7F6E")},5e3);function y(a){_.value=!0,s.value=[+a.coords.longitude,+a.coords.latitude],o.value=[+a.coords.longitude,+a.coords.latitude],n.AMap.load().then(async e=>{await n.AMap.convertGps(e,o.value).then(l=>{s.value=l,o.value=l}),d.value=await m(e,o.value);const t=new e.Map("container");t.setCenter(s.value,!0),t.setZoom(18,!0),p(t,e),f(t,e),n.Message.closeLoadingToast(),t.on("click",l=>{}),t.on("moveend",async l=>{let r=t.getCenter();o.value=[r.lng,r.lat],t.remove(v),p(t,e),s.value=[r.lng,r.lat],t.remove(i),f(t,e),d.value=await m(e,o.value)+`(${o.value[0]}\uFF0C${o.value[1]})`})})}function p(a,e){v=new e.Marker({position:new e.LngLat(o.value[0],o.value[1]),title:"\u5317\u4EAC"}),a.add(v)}function f(a,e){i=new e.Circle({center:new e.LngLat(s.value[0],s.value[1]),radius:F,fillColor:"#e6f3ff",strokeColor:"#b3dbff",strokeWeight:2}),a.add(i)}async function m(a,e){return await n.AMap.reGeocoder(a,e).then(t=>t.formattedAddress)}return(a,e)=>{const t=S("van-button");return h(),C("div",$,[M,x(_)?(h(),C("footer",j,[G,g("p",null,L(d.value),1),B(t,{type:"primary"},{default:E(()=>[T("\u786E\u5B9A")]),_:1})])):P("",!0)])}}});const Z=V(U,[["__scopeId","data-v-8ed97ee3"]]);export{Z as default};
