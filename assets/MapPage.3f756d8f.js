import{d as D,r as c,s as k,o as C,c as w,u as L,b as g,t as x,g as B,h as E,q as P,p as b,j as S,A as T,y as I,z as N}from"./index.5acec26a.js";import{_ as V}from"./houcdc0426e.js";const F=u=>(I("data-v-2872966e"),u=u(),N(),u),$={class:"mapPage"},M=F(()=>g("div",{id:"container"},null,-1)),j={key:0,class:"radius padding"},G=F(()=>g("p",null,"\u60A8\u73B0\u5728\u7684\u4F4D\u7F6E\u662F\uFF1A",-1)),U=D({__name:"MapPage",setup(u){const n=b("$Utils"),i=c("");let d=null,v=null,s=c([0,0]),o=c([0,0]),y=50,_=c(!1);k(()=>{n.Message.showLoadingToast(),navigator.geolocation&&navigator.geolocation.getCurrentPosition(p)}),setTimeout(()=>{_.value||n.Message.failToast("\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u83B7\u53D6\u5F53\u524D\u4F4D\u7F6E")},5e3),p({coords:{longitude:116.274114,latitude:39.840426}});function p(a){_.value=!0,s.value=[+a.coords.longitude,+a.coords.latitude],o.value=[+a.coords.longitude,+a.coords.latitude],n.AMap.load().then(async e=>{await n.AMap.convertGps(e,o.value).then(l=>{s.value=l,o.value=l}),i.value=await h(e,o.value);const t=new e.Map("container");t.setCenter(s.value,!0),t.setZoom(18,!0),f(t,e),m(t,e),n.Message.closeLoadingToast(),t.on("click",l=>{}),t.on("moveend",async l=>{let r=t.getCenter();o.value=[r.lng,r.lat],t.remove(v),f(t,e),s.value=[r.lng,r.lat],t.remove(d),m(t,e),i.value=await h(e,o.value)+`(${o.value[0]}\uFF0C${o.value[1]})`})})}function f(a,e){v=new e.Marker({position:new e.LngLat(o.value[0],o.value[1]),title:"\u5317\u4EAC"}),a.add(v)}function m(a,e){d=new e.Circle({center:new e.LngLat(s.value[0],s.value[1]),radius:y,fillColor:"#e6f3ff",strokeColor:"#b3dbff",strokeWeight:2}),a.add(d)}async function h(a,e){return await n.AMap.reGeocoder(a,e).then(t=>t.formattedAddress)}return(a,e)=>{const t=S("van-button");return C(),w("div",$,[M,L(_)?(C(),w("footer",j,[G,g("p",null,x(i.value),1),B(t,{type:"primary"},{default:E(()=>[T("\u786E\u5B9A")]),_:1})])):P("",!0)])}}});const A=V(U,[["__scopeId","data-v-2872966e"]]);export{A as default};
