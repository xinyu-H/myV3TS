import{d as D,r as c,m as b,o as h,c as C,u as k,b as f,t as x,g as L,w as B,v as E,s as P,h as S,x as T,p as I,q as N}from"./index.fbf3ec70.js";import{_ as V}from"./_plugin-vue_export-helper.cdc0426e.js";const w=s=>(I("data-v-8baa45f0"),s=s(),N(),s),$={class:"mapPage"},A=w(()=>f("div",{id:"container"},null,-1)),G={key:0,class:"radius padding"},U=w(()=>f("p",null,"\u60A8\u73B0\u5728\u7684\u4F4D\u7F6E\u662F\uFF1A",-1)),j=D({__name:"MapPage",setup(s){const n=P("$Utils"),i=c("");let d=null,v=null,u=c([0,0]),o=c([0,0]),F=50,_=c(!1);b(()=>{n.Alert.showLoadingToast(),navigator.geolocation&&navigator.geolocation.getCurrentPosition(y)}),setTimeout(()=>{_.value||n.Alert.failToast("\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u83B7\u53D6\u5F53\u524D\u4F4D\u7F6E")},5e3);function y(a){_.value=!0,u.value=[+a.coords.longitude,+a.coords.latitude],o.value=[+a.coords.longitude,+a.coords.latitude],n.AMap.load().then(async e=>{await n.AMap.convertGps(e,o.value).then(l=>{u.value=l,o.value=l}),i.value=await m(e,o.value);const t=new e.Map("container");t.setCenter(u.value,!0),t.setZoom(18,!0),p(t,e),g(t,e),n.Alert.closeLoadingToast(),t.on("click",l=>{}),t.on("moveend",async l=>{let r=t.getCenter();o.value=[r.lng,r.lat],t.remove(v),p(t,e),u.value=[r.lng,r.lat],t.remove(d),g(t,e),i.value=await m(e,o.value)+`(${o.value[0]}\uFF0C${o.value[1]})`})})}function p(a,e){v=new e.Marker({position:new e.LngLat(o.value[0],o.value[1]),title:"\u5317\u4EAC"}),a.add(v)}function g(a,e){d=new e.Circle({center:new e.LngLat(u.value[0],u.value[1]),radius:F,fillColor:"#e6f3ff",strokeColor:"#b3dbff",strokeWeight:2}),a.add(d)}async function m(a,e){return await n.AMap.reGeocoder(a,e).then(t=>t.formattedAddress)}return(a,e)=>{const t=S("van-button");return h(),C("div",$,[A,k(_)?(h(),C("footer",G,[U,f("p",null,x(i.value),1),L(t,{type:"primary"},{default:B(()=>[T("\u786E\u5B9A")]),_:1})])):E("",!0)])}}});const Z=V(j,[["__scopeId","data-v-8baa45f0"]]);export{Z as default};
